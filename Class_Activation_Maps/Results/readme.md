## **Results** ##
<p align="justify"> Figure 1 to Figure 7 represents the implementation of class activation maps on seven different classes given in the dataset. The top image in each figure’s subplot (a) represents the input image, i.e., skin lesion image of size (450, 600, 3). The correct label and the probability assigned to the correct label is written under each image. The bottom image in each figure’s subplot (a) is a bar plot, which denotes three labels considered most probable by the model. The green color represents the correct label, and the red color represents all the other labels in the bar plot. Subplot (b) represents the pre-processed image i.e. normalized in the range [-1, 1]. Subplot (c) represents the heatmap superimposed on the input image using Jet colormap array ranging from blue (low value) to red (high value). The red is the high-intensity area, i.e., the region is very important, and blue indicates the low-intensity area, i.e., the less important region, but still relevant enough to locate the skin lesion. 
<div align="center">
<img src="https://github.com/rao208/Explainable_AI/blob/master/Class_Activation_Maps/Results/akk_5_cam-1.svg" >
<p><b>Figure 1:</b> Class Activation Maps result in Actinic Keratoses class: (a) Input Image with top 3 predictions (b) Pre-processed Image (c) Heatmap on the input image</p>
</div>  

<div align="center">
<img src="https://github.com/rao208/Explainable_AI/blob/master/Class_Activation_Maps/Results/bcc_1_cam-1.svg" >
<p><b>Figure 2:</b> Class Activation Maps result in Basal Cell Carcinoma class: (a) Input Image with top 3 predictions (b) Pre-processed Image (c) Heatmap on the input image</p>
</div>  

<div align="center">
<img src="https://github.com/rao208/Explainable_AI/blob/master/Class_Activation_Maps/Results/bkk_51_cam-1.svg" >
<p><b>Figure 3:</b> Class Activation Maps result in Benign Keratosis class: (a) Input Image with top 3 predictions (b) Pre-processed Image (c) Heatmap on the input image</p>
</div>  

<div align="center">
<img src="https://github.com/rao208/Explainable_AI/blob/master/Class_Activation_Maps/Results/df_9_cam.svg" >
<p><b>Figure 4:</b> Class Activation Maps result in Dermatofibroma class: (a) Input Image with top 3 predictions (b) Pre-processed Image (c) Heatmap on the input image</p>
</div>  

<div align="center">
<img src="https://github.com/rao208/Explainable_AI/blob/master/Class_Activation_Maps/Results/mcy_2_cam-1.svg" >
<p><b>Figure 5:</b> Class Activation Maps result in Melanocytic Nevi class: (a) Input Image with top 3 predictions (b) Pre-processed Image (c) Heatmap on the input image</p>
</div>  

<div align="center">
<img src="https://github.com/rao208/Explainable_AI/blob/master/Class_Activation_Maps/Results/mel_38_cam.svg" >
<p><b>Figure 6:</b> Class Activation Maps result in Melanoma class: (a) Input Image with top 3 predictions (b) Pre-processed Image (c) Heatmap on the input image</p>
</div>  

<div align="center">
<img src="https://github.com/rao208/Explainable_AI/blob/master/Class_Activation_Maps/Results/vasc_4_cam-1.svg" >
<p><b>Figure 7:</b> Class Activation Maps result in Vascular Lesions class: (a) Input Image with top 3 predictions (b) Pre-processed Image (c) Heatmap on the input image</p>
</div>  
<p align="justify"> As expected, the trained CNN model is looking for a specific feature. Based on the different morphologic variants such as rash, nodule, pigmentation, irregular patch, cyst on the surface of the skin, or areas of skin that look different from the surrounding area, CNN determines the coarse and irregular portions of a lesion to be important features. These features are used as the basis for its classification of skin lesions. If the predicted probability of the target class is high, then the heatmap on the important features, i.e., the affected area, is more intense. The higher the intensity of the heatmap, the model is surer about the location of the affected area based on these learned features. </p>  

<p align="justify"> A test is conducted to observe the effect on the heatmap generated by different classes that were predicted by the model on the same image. Before the test is conducted on skin lesions, it is first tried on the Dogs vs Cats model. This is because it is easy to verify the results of this test on a simple image. Figure 8 shows the results of this test and highlights the differences in heatmaps generated by CAM for a single image when different classes are used. It can be observed that the heatmap regions for different categories are different in a given image.</p>  

<div align="center">
<img src="https://github.com/rao208/Explainable_AI/blob/master/Class_Activation_Maps/Results/Cat_5_classes.svg" >
<p><b>Figure 8:</b>The differences in the heatmap generated by CAM for a single image when using different classes on cat image (a) Input Image with the prediction (b) Class Activation Maps results for the Cat class (c) Class Activation Maps results for Dog class</p>
</div>  

<p align="justify">Figure 8(a) shows the input image with ground-truth and its prediction score displayed on top of the image. The ground truth of the input image is cat, and for the given input image, the classifier predicts the cat label with the probability of 0.94 and predicts the label dog with the probability of 0.06. Figure 8(b) displays the heatmap of the predicted label cat. It is observed that for a correct prediction, CAM generates the heatmap on the face of the cat. This indicates that the cat’s face was the decisive factor for CNN to predict the label cat. Figure 8(c) displays the heatmap of the predicted label dog. It is observed that CAM generates the heatmap on the paws of the cat. It indicates that this region was the reason why CNN also predicted the dog class with very low probability.</p>  

<p align="justify">The same experiment was carried out on the skin lesion image. Figure 9(a) is the input image with the ground truth as Benign Keratosis, as displayed on top of the image. Figure 53(b) is the pre-processed image. Figure 9(c) - Figure 9(f) highlight the differences in the heatmaps generated by CAM for a single image when using different classes. The trained model predicted the input image as Benign Keratosis with prediction probability 0.93. The other predictions made by the model are Melanoma with prediction probability 0.04, Melanocytic Nevi with prediction probability 0.02, and Vascular Lesions with very low prediction probability 0.01. The possible explanation of why the model gave different heatmap in different areas were drawn based on the different references([1]-[7]). The truthfulness of the conclusions and the results should be verified by the experts. </p>

<div align="center">
<img src="https://github.com/rao208/Explainable_AI/blob/master/Class_Activation_Maps/Results/bkl_multiple_heatmaps-1.svg" >
<p><b>Figure 9:</b>The differences in the heatmap generated by CAM for a single image when using different classes on Benign Keratosis skin lesion image (a) Input Image with the prediction (b) Pre-processed Image (c) Class Activation Maps results for the Benign Keratosis class (d) Class Activation Maps results for Melanoma class (e) Class Activation Maps results for Melanocytic Nevi class (f) Class Activation Maps results for Vascular Lesions class</p>
</div>  

## **References** ##

[1]C. Praetorius, R. Sturm, and E. Steingrímsson, “Sun-induced freckling: Ephelides and solar lentigines.,” Pigment cell melanoma research, vol. 27, 02 2014.  
[2] N. Nagrani, N. Jaimes, M. Oliviero, and H. Rabinovitz, “Lichen planus-like keratosis: clinical applicability of in vivo reflectance confocal microscopy for an indeterminate cutaneous lesion,” Dermatology Practical Conceptual, vol. 8, pp. 180–183, 07 2018.  
[3] F. JAMES Q. DEL ROSSO, DO, FAOCD, “A Closer Look at Seborrheic Keratoses:,” journal of clinical and aesthetic dermatology March, vol. 10, no. 3, 2017.  
[4] R. Kasmi and K. Mokrani, “Classification of malignant melanoma and benign skin lesions: implementation of automatic abcd rule,” IET Image Processing, vol. 10, no. 6, pp. 448–455, 2016.  
[5] H. P. Soyer, G. Argenziano, R. Hofmann-Wellenhof, and R. H. Johr, eds., Nevi with Particular Pigmentation: Black, Pink, and White Nevus, pp. 142–146. Berlin, Heidelberg: Springer Berlin Heidelberg, 2007.  
[6] N. Syed, “Vascular lesions of head and neck: A literature review,” Indian Journal of Dental Sciences, vol. 8, p. 176, 01 2016.  
[7] N. H. Cox and I. H. Coulson, Diagnosis of Skin Disease, ch. 5, pp. 1–26. John Wiley Sons, Ltd, 2010.  
